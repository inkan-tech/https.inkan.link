<!DOCTYPE html>
{{/* Detect language from URL pattern for proper lang attribute */}}
{{- $url := .Permalink -}}
{{- $lang := "fr" -}}
{{- if or (strings.Contains $url "/en/") (strings.HasSuffix $url "/en") -}}
  {{- $lang = "en" -}}
{{- end -}}
<html lang="{{ $lang }}" xml:lang="{{ $lang }}">
  <head>
    <title>{{ .Permalink }}</title>
    <link rel="canonical" href="{{ .Permalink }}">
    {{/* Changed from noindex to index,follow for SEO - redirects should be followed */}}
    <meta name="robots" content="index,follow">
    <meta charset="utf-8">
    <meta http-equiv="refresh" content="0; url={{ .Permalink }}">
    {{/* Hreflang tags for alias pages */}}
    {{/* Extract base URL (protocol + domain) from permalink */}}
    {{- $baseURL := "" -}}
    {{- if strings.HasPrefix $url "http://" -}}
      {{- $baseURL = replaceRE "^(https?://[^/]+).*" "$1" $url -}}
    {{- else if strings.HasPrefix $url "https://" -}}
      {{- $baseURL = replaceRE "^(https?://[^/]+).*" "$1" $url -}}
    {{- end -}}
    {{/* Self-referencing hreflang */}}
    <link rel="alternate" hreflang="{{ $lang }}" href="{{ $url }}">
    {{/* Add alternate language link */}}
    {{ if eq $lang "fr" }}
      {{/* French page - add English alternate */}}
      {{- $enURL := printf "%s/en/" $baseURL -}}
      <link rel="alternate" hreflang="en" href="{{ $enURL }}">
      <link rel="alternate" hreflang="x-default" href="{{ $url }}">
    {{ else }}
      {{/* English page - add French alternate */}}
      {{- $frURL := strings.Replace $url "/en/" "/" 1 -}}
      <link rel="alternate" hreflang="fr" href="{{ $frURL }}">
      <link rel="alternate" hreflang="x-default" href="{{ $frURL }}">
    {{ end }}
  </head>
</html>
